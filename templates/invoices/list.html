{% extends "invoices/base.html" %}
{% block title %}Invoices{% endblock %}

{% block content %}
<div class="card p-4">
  <h3 class="mb-4">üìë All Invoices</h3>

  <form method="get" class="mb-3 d-flex">
    <input type="text" name="q" class="form-control me-2" placeholder="Search invoice no / party">
    <button class="btn btn-primary">Search</button>
  </form>

  <table class="table table-striped table-bordered align-middle text-center">
    <thead class="table-light">
      <tr>
        <th>No</th>
        <th>Date</th>
        <th>From</th>
        <th>To</th>
        <th>Total</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for inv in invoices %}
      <tr>
        <td>{{ inv.invoice_number }}</td>
        <td>{{ inv.date }}</td>
        <td>{{ inv.from_party.name }}</td>
        <td>{{ inv.to_party.name }}</td>
        <td>‚Çπ{{ inv.grand_total }}</td>
        <td>
          <a href="{% url 'invoices:preview' inv.pk %}" class="btn btn-sm btn-info">üëÅ Preview</a>
          <a href="{% url 'invoices:download' inv.pk %}" class="btn btn-sm btn-success">‚¨á PDF</a>
          <a href="{% url 'invoices:delete' inv.pk %}" class="btn btn-sm btn-danger"
             onclick="return confirm('Delete this invoice?')">üóë Delete</a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="6">No invoices found.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="mt-3">
    {% if invoices.has_other_pages %}
      <nav>
        <ul class="pagination">
          {% if invoices.has_previous %}
            <li class="page-item"><a class="page-link" href="?page={{ invoices.previous_page_number }}">&laquo;</a></li>
          {% endif %}
          {% for num in invoices.paginator.page_range %}
            <li class="page-item {% if invoices.number == num %}active{% endif %}">
              <a class="page-link" href="?page={{ num }}">{{ num }}</a>
            </li>
          {% endfor %}
          {% if invoices.has_next %}
            <li class="page-item"><a class="page-link" href="?page={{ invoices.next_page_number }}">&raquo;</a></li>
          {% endif %}
        </ul>
      </nav>
    {% endif %}
  </div>
</div>
{% endblock %}
