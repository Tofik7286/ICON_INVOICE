{% extends "invoices/base.html" %}
{% block title %}Invoices{% endblock %}

{% block content %}
<div class="card p-4">
  <h3 class="mb-4">ğŸ“‘ All Invoices</h3>

  <!-- Search -->
  <form method="get" class="mb-3 d-flex">
    <input type="text" name="q" class="form-control me-2" placeholder="Search invoice no / party" value="{{ request.GET.q }}">
    <button class="btn btn-primary">Search</button>
  </form>

  <!-- âœ… Desktop Table -->
  <div class="d-none d-md-block">
    <table class="table table-striped table-bordered align-middle text-center">
      <thead class="table-light">
        <tr>
          <th>No</th>
          <th>Date</th>
          <th>From</th>
          <th>To</th>
          <th>Total</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for inv in invoices %}
        <tr>
          <td>{{ inv.invoice_number }}</td>
          <td>{{ inv.date }}</td>
          <td>{{ inv.from_party.name }}</td>
          <td>{{ inv.to_party.name }}</td>
          <td>â‚¹{{ inv.grand_total }}</td>
          <td>
            <a href="{% url 'invoices:preview' inv.pk %}" class="btn btn-sm btn-info">ğŸ‘ Preview</a>
            <a href="{% url 'invoices:generate_pdf' inv.pk %}" class="btn btn-sm btn-success">â¬‡ PDF</a>
            <a href="{% url 'invoices:delete' inv.pk %}" class="btn btn-sm btn-danger"
               onclick="return confirm('Delete this invoice?')">ğŸ—‘ Delete</a>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="6">No invoices found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

    <!-- âœ… Mobile Cards -->
  <div class="d-md-none">
    {% for inv in invoices %}
    <div class="border rounded p-3 mb-3 bg-white shadow-sm">
      <div class="d-flex justify-content-between">
        <strong>Invoice #{{ inv.invoice_number }}</strong>
        <small class="text-muted">{{ inv.date }}</small>
      </div>
      <div class="mt-2">
        <div><strong>From:</strong> {{ inv.from_party.name }}</div>
        <div><strong>To:</strong> {{ inv.to_party.name }}</div>
        <div><strong>Total:</strong> â‚¹{{ inv.grand_total }}</div>
      </div>
      <div class="mt-2 d-flex flex-wrap gap-2">
        <a href="{% url 'invoices:preview' inv.pk %}" class="btn btn-sm btn-info">ğŸ‘ Preview</a>
        <a href="{% url 'invoices:generate_pdf' inv.pk %}" class="btn btn-sm btn-success">â¬‡ PDF</a>
        <a href="{% url 'invoices:delete' inv.pk %}" class="btn btn-sm btn-danger"
           onclick="return confirm('Delete this invoice?')">ğŸ—‘ Delete</a>
      </div>
    </div>
    {% empty %}
    <div class="text-center text-muted">No invoices found.</div>
    {% endfor %}
  </div>
{% endblock %}